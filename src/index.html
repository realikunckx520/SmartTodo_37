<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8"/>
    <title>SmartTodo</title>
</head>
<body>
    <h2>SmartTodo 待办管理系统（UI分支开发</h2>

    <input id="taskInput" placeholder="输入待办任务"/>
    <button onclick="addTodo()">添加</button>

    <ul id="list"></ul>

    <script>
        const api = "http://localhost:5000/todos"

        async function loadTodos() {
            const res = await fetch(api)
            const data = await res.json()
            const list = document.getElementById("list")
            list.innerHTML = ""
            data.forEach(item => {
                list.innerHTML += `<li>${item.task} 
                    <button onclick="del(${item.id})">删除</button>
                </li>`
            })
        }

        async function addTodo() {
            const task = document.getElementById("taskInput").value
            await fetch(api, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({task})
            })
            loadTodos()
        }

        async function del(id) {
            await fetch(api + "/" + id, {method: "DELETE"})
            loadTodos()
        }

        loadTodos()
    </script>
</body>
</html>
